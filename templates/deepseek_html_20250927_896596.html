<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="dark">
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>▶️</text></svg>">
  <title>OVP - Enhanced Video Player</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #fff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow: hidden;
    }

    #video_container {
      position: relative;
      width: 100%;
      height: 100vh;
      background: #000;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    video {
      width: 100%;
      height: 100%;
      background: #000;
      object-fit: contain;
      flex-grow: 1;
    }

    /* Enhanced Controls */
    #controls {
      position: absolute;
      bottom: 0;
      width: 100%;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
      transition: opacity 0.3s ease;
      z-index: 10;
    }

    #video_header {
      position: absolute;
      top: 0;
      width: 100%;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(rgba(0, 0, 0, 0.7), transparent);
      z-index: 10;
      transition: opacity 0.3s ease;
    }

    #upper_controls_container {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    #video_title_container {
      max-width: 70%;
    }

    #video_title {
      font-size: 1.4rem;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .control_btn {
      background: rgba(30, 30, 30, 0.8);
      border: none;
      border-radius: 10px;
      cursor: pointer;
      color: #fff;
      text-decoration: none;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      transition: all 0.2s ease;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      min-width: 50px;
      height: 50px;
    }

    .control_btn:hover {
      background: rgba(50, 50, 50, 0.9);
      transform: scale(1.05);
    }

    .control_btn:active {
      transform: scale(0.95);
    }

    #time_controls_container {
      display: flex;
      align-items: center;
      gap: 15px;
      width: 100%;
    }

    #time_range {
      flex: 1;
      height: 8px;
      border-radius: 4px;
      background: #444;
      outline: none;
      -webkit-appearance: none;
    }

    #time_range::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    }

    #time_range::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
      border: none;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    }

    #time_value {
      font-size: 1.1rem;
      font-weight: 600;
      min-width: 80px;
      text-align: center;
    }

    #control_buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }

    .controls_grp {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    #volume_controls_container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    #volume {
      width: 100px;
      height: 6px;
      border-radius: 3px;
      background: #444;
      outline: none;
      -webkit-appearance: none;
    }

    #volume::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
    }

    #volume::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
      border: none;
    }

    #currentSpeed {
      font-size: 1.1rem;
      font-weight: 600;
    }

    progress {
      width: 100%;
      height: 6px;
      position: absolute;
      top: -6px;
      left: 0;
      background: #333;
      border-radius: 3px;
      overflow: hidden;
    }

    progress::-webkit-progress-bar {
      background: #444;
      border-radius: 3px;
    }
    
    progress::-webkit-progress-value {
      background: #aaa;
      border-radius: 3px;
    }
    
    progress::-moz-progress-bar {
      background: #aaa;
      border-radius: 3px;
    }

    /* Spinner */
    .spinner {
      border: 8px solid rgba(255, 255, 255, 0.3);
      border-top: 8px solid #fff;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      z-index: 5;
    }

    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }

    /* Error message */
    #errorContainer {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #ff5555;
      font-size: 1.5rem;
      display: none;
      z-index: 5;
    }

    /* Fullscreen adjustments */
    :fullscreen #controls {
      padding: 25px;
    }

    :fullscreen #video_header {
      padding: 25px;
    }

    :fullscreen .control_btn {
      padding: 15px;
      min-width: 60px;
      height: 60px;
    }

    :fullscreen #time_value {
      font-size: 1.3rem;
    }

    :fullscreen #currentSpeed {
      font-size: 1.3rem;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      #controls {
        padding: 15px;
      }
      
      #video_header {
        padding: 15px;
      }
      
      .control_btn {
        padding: 10px;
        min-width: 45px;
        height: 45px;
      }
      
      #time_value {
        font-size: 1rem;
        min-width: 70px;
      }
      
      #volume {
        width: 80px;
      }
      
      #video_title {
        font-size: 1.2rem;
      }
    }

    @media (max-width: 480px) {
      #controls {
        padding: 10px;
      }
      
      #video_header {
        padding: 10px;
      }
      
      .controls_grp {
        gap: 5px;
      }
      
      .control_btn {
        padding: 8px;
        min-width: 40px;
        height: 40px;
      }
      
      #time_value {
        font-size: 0.9rem;
        min-width: 60px;
      }
      
      #volume {
        width: 60px;
      }
      
      #video_title {
        font-size: 1rem;
      }
    }

    /* Hide controls when not interacting */
    #video_container:not(:hover) #controls,
    #video_container:not(:hover) #video_header {
      opacity: 0;
      pointer-events: none;
    }

    /* Always show controls when paused or in fullscreen */
    #video_container.paused #controls,
    #video_container.paused #video_header,
    :fullscreen #controls,
    :fullscreen #video_header {
      opacity: 1;
      pointer-events: all;
    }
  </style>
</head>

<body>
  <main id="video_container">
    <h1 id="errorContainer"></h1>
    <div class="spinner"></div>

    <!-- upper controls -->
    <div id="video_header">
      <div id="upper_controls_container">
        <button class="control_btn" id="return" title="Return">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <div id="video_title_container">
          <h3 id="video_title">Enhanced Video Player</h3>
        </div>
      </div>
      <div>
        <button class="control_btn" id="replay" title="Replay">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2 10C2 10 4.00498 7.26822 5.63384 5.63824C7.26269 4.00827 9.5136 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.89691 21 4.43511 18.2543 3.35177 14.5M2 10V4M2 10H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button class="control_btn" id="aspectRatio" title="Change aspect ratio">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
            <path d="M9 9H15V15H9V9Z" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- main controls -->
    <div id="controls">
      <div id="time_controls_container">
        <input id="time_range" type="range" value="0" min="0" max="100" step="0.01">
        <progress id="bufferingIndicator" value="0" max="100"></progress>
        <span id="time_value">00:00:00</span>
      </div>
      <div id="control_buttons">
        <div class="controls_grp center_controls">
          <button class="control_btn" id="playPause" title="Play/Pause">
            <svg id="playPauseIcon" width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 5V19M16 5V19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button class="control_btn" id="back" title="Backward 10s">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 12L13.5 17.1962L13.5 6.80385L21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M11 12L3.5 17.1962L3.5 6.80385L11 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M19 9V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button class="control_btn" id="forward" title="Forward 10s">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 12L10.5 6.80385L10.5 17.1962L3 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M13 12L20.5 6.80385L20.5 17.1962L13 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M5 9V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <div id="volume_controls_container">
            <button class="control_btn" id="toggleMute" title="Toggle Mute">
              <svg id="volumeIcon" width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 8.37063C15 7.03231 16.3431 6.15803 17.5 6.80223C19.0715 7.67651 20.2143 9.22021 20.2143 11C20.2143 12.7798 19.0715 14.3235 17.5 15.1978C16.3431 15.842 15 14.9677 15 13.6294V8.37063Z" stroke="currentColor" stroke-width="2"/>
                <path d="M4 8H7L12 3V19L7 14H4V8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <input type="range" id="volume" min="0" max="100" step="1" value="100">
          </div>
        </div>
        <div class="controls_grp right_controls">
          <button class="control_btn" id="videoSpeed" title="Change speed">
            <span id="currentSpeed">1x</span>
          </button>
          <a id="openBtn" target="_blank" class="control_btn" title="Open in new tab">Open</a>
          <a id="downloadBtn" class="control_btn" title="Download Video" download>Download</a>
          <button class="control_btn" id="fullscreen" title="Fullscreen">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 3H5C4.44772 3 4 3.44772 4 4V7M20 7V4C20 3.44772 19.5523 3 19 3H16M16 21H19C19.5523 21 20 20.5523 20 20V17M4 17V20C4 20.5523 4.44772 21 5 21H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- video -->
    <video id="main_vid" autoplay>
      <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
      <h2 class="error">Sorry, your browser doesn't support HTML5 video.</h2>
    </video>
  </main>

  <script>
    const video = document.getElementById("main_vid");
    const playPauseIcon = document.getElementById("playPauseIcon");
    const timeRange = document.getElementById("time_range");
    const timeValue = document.getElementById("time_value");
    const volumeSlider = document.getElementById("volume");
    const volumeIcon = document.getElementById("volumeIcon");
    const speedDisplay = document.getElementById("currentSpeed");
    const bufferingIndicator = document.getElementById("bufferingIndicator");
    const spinner = document.querySelector(".spinner");
    const openBtn = document.getElementById("openBtn");
    const downloadBtn = document.getElementById("downloadBtn");
    const videoContainer = document.getElementById("video_container");
    const videoTitle = document.getElementById("video_title");
    const errorContainer = document.getElementById("errorContainer");

    // Set video title from source
    const sourceEl = video.querySelector("source");
    if (sourceEl && sourceEl.src) {
      const url = new URL(sourceEl.src);
      videoTitle.textContent = decodeURIComponent(url.pathname.split('/').pop()) || "Enhanced Video Player";
    }

    const player = {
      playPause() {
        if (video.paused) {
          video.play();
          playPauseIcon.innerHTML = '<path d="M8 5V19M16 5V19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>';
          videoContainer.classList.remove("paused");
        } else {
          video.pause();
          playPauseIcon.innerHTML = '<path d="M8 5.5V18.5C8 19.0523 8.44772 19.5 9 19.5H10C10.5523 19.5 11 19.0523 11 18.5V5.5C11 4.94772 10.5523 4.5 10 4.5H9C8.44772 4.5 8 4.94772 8 5.5Z" stroke="currentColor" stroke-width="2"/><path d="M15 5.5V18.5C15 19.0523 15.4477 19.5 16 19.5H17C17.5523 19.5 18 19.0523 18 18.5V5.5C18 4.94772 17.5523 4.5 17 4.5H16C15.4477 4.5 15 4.94772 15 5.5Z" stroke="currentColor" stroke-width="2"/>';
          videoContainer.classList.add("paused");
        }
      },

      replay() {
        video.currentTime = 0;
        video.play();
        videoContainer.classList.remove("paused");
      },

      forward() {
        video.currentTime += 10;
      },

      backward() {
        video.currentTime -= 10;
      },

      toggleMute() {
        video.muted = !video.muted;
        if (video.muted) {
          volumeIcon.innerHTML = '<path d="M4 8H7L12 3V19L7 14H4V8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M17 9L21 13M21 9L17 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>';
        } else {
          volumeIcon.innerHTML = '<path d="M15 8.37063C15 7.03231 16.3431 6.15803 17.5 6.80223C19.0715 7.67651 20.2143 9.22021 20.2143 11C20.2143 12.7798 19.0715 14.3235 17.5 15.1978C16.3431 15.842 15 14.9677 15 13.6294V8.37063Z" stroke="currentColor" stroke-width="2"/><path d="M4 8H7L12 3V19L7 14H4V8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>';
        }
      },

      changeSpeed() {
        const speeds = [0.5, 0.75, 1, 1.25, 1.5, 2];
        let current = speeds.indexOf(video.playbackRate);
        let next = (current + 1) % speeds.length;
        video.playbackRate = speeds[next];
        speedDisplay.textContent = speeds[next] + "x";
      },

      changeAspectRatio() {
        const modes = ["contain", "cover", "fill"];
        let current = modes.indexOf(video.style.objectFit || "contain");
        let next = (current + 1) % modes.length;
        video.style.objectFit = modes[next];
      },

      fullScreen() {
        if (!document.fullscreenElement) {
          videoContainer.requestFullscreen();
        } else {
          document.exitFullscreen();
        }
      }
    };

    // Update Open & Download buttons when source changes
    function updateVideoUrl(url) {
      openBtn.href = url;
      downloadBtn.href = url;
      downloadBtn.download = url.split('/').pop() || "video.mp4";
    }

    // Initial setup with default source
    if (sourceEl && sourceEl.src) {
      updateVideoUrl(sourceEl.src);
    }

    // Update progress bar
    video.addEventListener("timeupdate", () => {
      let percent = (video.currentTime / video.duration) * 100;
      timeRange.value = percent || 0;

      // Time display
      let h = Math.floor(video.currentTime / 3600);
      let m = Math.floor((video.currentTime % 3600) / 60);
      let s = Math.floor(video.currentTime % 60);
      timeValue.textContent = [h, m, s].map(v => String(v).padStart(2, "0")).join(":");
    });

    // Seek
    timeRange.addEventListener("input", () => {
      video.currentTime = (timeRange.value / 100) * video.duration;
    });

    // Volume control
    volumeSlider.addEventListener("input", () => {
      video.volume = volumeSlider.value / 100;
      video.muted = video.volume === 0;
      if (video.muted) {
        volumeIcon.innerHTML = '<path d="M4 8H7L12 3V19L7 14H4V8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M17 9L21 13M21 9L17 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>';
      } else {
        volumeIcon.innerHTML = '<path d="M15 8.37063C15 7.03231 16.3431 6.15803 17.5 6.80223C19.0715 7.67651 20.2143 9.22021 20.2143 11C20.2143 12.7798 19.0715 14.3235 17.5 15.1978C16.3431 15.842 15 14.9677 15 13.6294V8.37063Z" stroke="currentColor" stroke-width="2"/><path d="M4 8H7L12 3V19L7 14H4V8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>';
      }
    });

    // Buffering indicator
    video.addEventListener("waiting", () => {
      spinner.style.display = "block";
      videoContainer.classList.add("paused");
    });
    
    video.addEventListener("playing", () => {
      spinner.style.display = "none";
      videoContainer.classList.remove("paused");
    });
    
    video.addEventListener("progress", () => {
      if (video.buffered.length > 0) {
        let end = video.buffered.end(video.buffered.length - 1);
        let percent = (end / video.duration) * 100;
        bufferingIndicator.value = percent;
      }
    });

    // Error handling
    video.addEventListener("error", () => {
      errorContainer.textContent = "Error loading video. Please check the URL.";
      errorContainer.style.display = "block";
      spinner.style.display = "none";
    });

    // Event listeners for buttons
    document.getElementById("playPause").addEventListener("click", () => player.playPause());
    document.getElementById("replay").addEventListener("click", () => player.replay());
    document.getElementById("back").addEventListener("click", () => player.backward());
    document.getElementById("forward").addEventListener("click", () => player.forward());
    document.getElementById("toggleMute").addEventListener("click", () => player.toggleMute());
    document.getElementById("videoSpeed").addEventListener("click", () => player.changeSpeed());
    document.getElementById("aspectRatio").addEventListener("click", () => player.changeAspectRatio());
    document.getElementById("fullscreen").addEventListener("click", () => player.fullScreen());
    document.getElementById("return").addEventListener("click", () => window.history.back());

    // Keyboard shortcuts
    document.addEventListener("keydown", (e) => {
      if (e.target.tagName === "INPUT") return; // Ignore if typing in an input
      
      switch(e.key) {
        case " ":
        case "k":
          e.preventDefault();
          player.playPause();
          break;
        case "f":
          player.fullScreen();
          break;
        case "m":
          player.toggleMute();
          break;
        case "ArrowLeft":
          player.backward();
          break;
        case "ArrowRight":
          player.forward();
          break;
        case "0":
          video.currentTime = 0;
          break;
        case "r":
          player.replay();
          break;
      }
    });

    // Auto-hide controls
    let controlsTimeout;
    function hideControls() {
      controlsTimeout = setTimeout(() => {
        if (!document.fullscreenElement && !video.paused) {
          videoContainer.style.cursor = "none";
        }
      }, 3000);
    }

    function showControls() {
      clearTimeout(controlsTimeout);
      videoContainer.style.cursor = "default";
      hideControls();
    }

    videoContainer.addEventListener("mousemove", showControls);
    video.addEventListener("click", () => player.playPause());
    
    // Initialize
    hideControls();
  </script>
</body>
</html>